# VBA

* 한셀에서 공부한 내용 옮기는 거라 엑셀이란 다른 부분 찾으면 수정 필요
* 강의서가 아니라 간단한 기록이기 때문에 프로그래밍 기본기 없이 보기는 어려움

## 1. 프로시저

### Sub
```
Sub 서브루틴명 [(인자1, 인자2, ...)]
    명령문
End Sub
```
#### 종료
```
Exit Sub
```
#### 호출
```
Call 서브루틴명
서브루틴명 [(인자1, 인자2, ...)]
```
### Function
```
Function 함수명 [(인자1, 인자2, ...)]
    명령문
    [함수명 = 식]
End Function
```
#### 종료
```
Exit Function
```
#### 호출
```
Call 함수명
함수명 [(인자1, 인자2, ...)]
```
인자가 없으면 Call을 붙이고 없으면 안 붙여야 됐던 걸로 기억함.
확인하면 수정 필요

## 2. 주석
```
' 주석내용
```

## 3. 데이터 형식
#### 타입 확인
```
Typename(변수)
```
타입 알려줌
Null, Boolean, Byte, Integer .... 종류는 특별할 것 없음

## 4. 연산자
### 산술, 연결, 비교 연산자
특별할 것 없이 +-<> 이용하면 됨
### 논리 연산자
Not, And, Or, Eqv, Xor 사용

## 5. 분기문, 반복문 등
### If
```
If 조건1 Then
    명령문1
[ElseIf 조건2 Then
    명령문2
Else
    명령문3)
End If
```
3항 연산자가 되던가? 확인하면 추가

### Case
```
Select Case 표현식
    Case 값1 [,값3, 값4..] / /값 여러개 표현'/
        명령문1
    [Case 값2 
        명령문2
    Case Else
        명령문3 ]
End Select
```

### For
```
For 변수 = 값1 To 값2 [step 값3]
    명령문
Next
```
```
For Each 요소 In 배열
    명령문
Next
```
For문 내에서 요소 값 사용가능

#### 종료
```
Exit For
```

### Do While
```
Do While 조건
    명령문
Loop
```
조건이 참인 동안 명령문 반복
```
Do
    명령문
Loop While 조건
```
루프를 일단 한번은 실행
#### 종료
```
Exit Do
```

### Do Until
```
Do Until 조건
    명령문
Loop
```
조건이 참인 동안 명령문 반복
```
Do
    명령문
Loop Until 조건
```
루프를 일단 한번은 실행

#### 종료
```
Exit Do
```

### While
```
While 조건
    명령문
Wend
```
이게 되나? 안 써봐서 모르겠는데 나중에 안되면 빼기

### With
```
With 개체
    명령문
    .속성
    .메소드
End With
```
이중으로 사용 가능하다.

## 6. 에러 제어문
```
On Error Resume Next '무시하고 넘어가기'
 ```
 ```
On Error GoTo 0 '기본값' / /에러를 무시하고 다음 줄로 넘어가게 하는 코드/
```
잘만 활용하면 코드 쓰기가 편해진다.

예시)
주변 셀을 확인하는 함수를 반복 시킬 때 (특히 재귀 함수에서)
행, 열이 1보다 작은 값을 참조하면 에러가 뜨는데
매번 범위를 확인하는 것보다 에러일 때 무시하고 끝내버리는 게
코드도 간단하고 연산도 줄어듦
